{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nexport default {\n  name: 'Login',\n  data() {\n    return {\n      username: '',\n      password: '',\n      errors: []\n    };\n  },\n  methods: {\n    async submitForm() {\n      this.$store.commit('setIsLoading', true);\n      axios.defaults.headers.common['Authorization'] = '';\n      localStorage.removeItem('token');\n      const formData = {\n        username: this.username,\n        password: this.password\n      };\n      await axios.post('/api/v1/token/login/', formData).then(response => {\n        const token = response.data.auth_token;\n        this.$store.commit('setToken', token);\n        axios.defaults.headers.common['Authorization'] = 'Token ' + token;\n        localStorage.setItem('token', token);\n      }).catch(error => {\n        if (error.response) {\n          for (const property in error.response.data) {\n            this.errors.push(`${property}: ${error.response.data[property]}`);\n          }\n        } else if (error.message) {\n          this.errors.push('Something went wrong. Please try again');\n        }\n      });\n      await axios.get('/api/v1/users/me').then(response => {\n        this.$store.commit('setuser', {\n          'id': response.data.id,\n          'username': response.data.username\n        });\n        localStorage.setItem('username', response.data.username);\n        localStorage.setItem('userid', response.data.id);\n        this.$router.push('/dashboard/my-account');\n      }).catch(error => {\n        console.log(error);\n      });\n      this.$store.commit('setIsLoading', false);\n    }\n  }\n};","map":{"version":3,"names":["axios","name","data","username","password","errors","methods","submitForm","$store","commit","defaults","headers","common","localStorage","removeItem","formData","post","then","response","token","auth_token","setItem","catch","error","property","push","message","get","id","$router","console","log"],"sources":["D:\\Courses\\web-programming-course\\homeworks\\6-crm\\crm_vue\\src\\views\\Login.vue"],"sourcesContent":["<template>\r\n  <div class=\"container\">\r\n    <div class=\"columns\">\r\n      <div class=\"column is-4 is-offset-4\">\r\n        <h1 class=\"is-size-2 has-text-centered has-text-weight-medium mb-5\">Login</h1>\r\n\r\n        <form @submit.prevent=\"submitForm\">\r\n\r\n          <div class=\"field\">\r\n            <div class=\"control\">\r\n              <input class=\"input\" type=\"email\" placeholder=\"Email\" v-model=\"username\">\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"field\">\r\n            <div class=\"control\">\r\n              <input class=\"input\" name=\"password\" type=\"password\" placeholder=\"Password\" v-model=\"password\">\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"field mt-5\">\r\n            <div class=\"control\">\r\n              <button class=\"button is-success is-normal is-fullwidth\">\r\n                Login\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"notification is-danger\" v-if=\"errors.length\">\r\n              <p v-for=\"error in errors\" :key=\"error\">{{ error }}</p>\r\n            </div>\r\n\r\n        </form>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\n\r\nexport default {\r\n  name: 'Login',\r\n  data() {\r\n    return {\r\n      username: '',\r\n      password: '',\r\n      errors: []\r\n    }\r\n  },\r\n  methods: {\r\n    async submitForm() {\r\n      this.$store.commit('setIsLoading', true)\r\n\r\n      axios.defaults.headers.common['Authorization'] = ''\r\n      localStorage.removeItem('token')\r\n\r\n      const formData = {\r\n        username: this.username,\r\n        password: this.password\r\n      }\r\n\r\n      await axios.post('/api/v1/token/login/', formData).then(response => {\r\n        const token = response.data.auth_token\r\n\r\n        this.$store.commit('setToken', token)\r\n\r\n        axios.defaults.headers.common['Authorization'] = 'Token ' + token\r\n\r\n        localStorage.setItem('token', token)\r\n      })\r\n        .catch(error => {\r\n          if (error.response) {\r\n            for (const property in error.response.data) {\r\n              this.errors.push(`${property}: ${error.response.data[property]}`)\r\n            }\r\n          } else if (error.message) {\r\n            this.errors.push('Something went wrong. Please try again')\r\n          }\r\n        })\r\n\r\n        await axios\r\n        .get('/api/v1/users/me')\r\n        .then(response => {\r\n          this.$store.commit('setuser', {'id': response.data.id, 'username': response.data.username})\r\n\r\n          localStorage.setItem('username', response.data.username)\r\n          localStorage.setItem('userid', response.data.id)\r\n\r\n          this.$router.push('/dashboard/my-account')\r\n        })\r\n        .catch(error => {\r\n          console.log(error);\r\n        })\r\n      this.$store.commit('setIsLoading', false)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>"],"mappings":";AAuCA,OAAOA,KAAI,MAAO,OAAO;AAEzB,eAAe;EACbC,IAAI,EAAE,OAAO;EACbC,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,EAAE;MACZC,MAAM,EAAE;IACV;EACF,CAAC;EACDC,OAAO,EAAE;IACP,MAAMC,UAAUA,CAAA,EAAG;MACjB,IAAI,CAACC,MAAM,CAACC,MAAM,CAAC,cAAc,EAAE,IAAI;MAEvCT,KAAK,CAACU,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,IAAI,EAAC;MAClDC,YAAY,CAACC,UAAU,CAAC,OAAO;MAE/B,MAAMC,QAAO,GAAI;QACfZ,QAAQ,EAAE,IAAI,CAACA,QAAQ;QACvBC,QAAQ,EAAE,IAAI,CAACA;MACjB;MAEA,MAAMJ,KAAK,CAACgB,IAAI,CAAC,sBAAsB,EAAED,QAAQ,CAAC,CAACE,IAAI,CAACC,QAAO,IAAK;QAClE,MAAMC,KAAI,GAAID,QAAQ,CAAChB,IAAI,CAACkB,UAAS;QAErC,IAAI,CAACZ,MAAM,CAACC,MAAM,CAAC,UAAU,EAAEU,KAAK;QAEpCnB,KAAK,CAACU,QAAQ,CAACC,OAAO,CAACC,MAAM,CAAC,eAAe,IAAI,QAAO,GAAIO,KAAI;QAEhEN,YAAY,CAACQ,OAAO,CAAC,OAAO,EAAEF,KAAK;MACrC,CAAC,EACEG,KAAK,CAACC,KAAI,IAAK;QACd,IAAIA,KAAK,CAACL,QAAQ,EAAE;UAClB,KAAK,MAAMM,QAAO,IAAKD,KAAK,CAACL,QAAQ,CAAChB,IAAI,EAAE;YAC1C,IAAI,CAACG,MAAM,CAACoB,IAAI,CAAE,GAAED,QAAS,KAAID,KAAK,CAACL,QAAQ,CAAChB,IAAI,CAACsB,QAAQ,CAAE,EAAC;UAClE;QACF,OAAO,IAAID,KAAK,CAACG,OAAO,EAAE;UACxB,IAAI,CAACrB,MAAM,CAACoB,IAAI,CAAC,wCAAwC;QAC3D;MACF,CAAC;MAED,MAAMzB,KAAI,CACT2B,GAAG,CAAC,kBAAkB,EACtBV,IAAI,CAACC,QAAO,IAAK;QAChB,IAAI,CAACV,MAAM,CAACC,MAAM,CAAC,SAAS,EAAE;UAAC,IAAI,EAAES,QAAQ,CAAChB,IAAI,CAAC0B,EAAE;UAAE,UAAU,EAAEV,QAAQ,CAAChB,IAAI,CAACC;QAAQ,CAAC;QAE1FU,YAAY,CAACQ,OAAO,CAAC,UAAU,EAAEH,QAAQ,CAAChB,IAAI,CAACC,QAAQ;QACvDU,YAAY,CAACQ,OAAO,CAAC,QAAQ,EAAEH,QAAQ,CAAChB,IAAI,CAAC0B,EAAE;QAE/C,IAAI,CAACC,OAAO,CAACJ,IAAI,CAAC,uBAAuB;MAC3C,CAAC,EACAH,KAAK,CAACC,KAAI,IAAK;QACdO,OAAO,CAACC,GAAG,CAACR,KAAK,CAAC;MACpB,CAAC;MACH,IAAI,CAACf,MAAM,CAACC,MAAM,CAAC,cAAc,EAAE,KAAK;IAC1C;EACF;AACF"},"metadata":{},"sourceType":"module","externalDependencies":[]}